<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/academicons-1.9.2/css/academicons.css">
<link rel="stylesheet" href="/assets/css/fontawesome-free-6.1.1-web/css/all.css">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">

<title>ğŸŒˆ From-scratched Pose-graph SLAM Tutorial: 1í¸</title>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ğŸŒˆ From-scratched Pose-graph SLAM Tutorial: 1í¸ | Giseop Kim Blog</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="ğŸŒˆ From-scratched Pose-graph SLAM Tutorial: 1í¸" />
<meta name="author" content="Giseop Kim" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Single Rotation Averaging ì„ êµ¬í˜„í•´ë³´ì ì–´ë µì§€ ì•Šì•„ìš” $\text{SO(3)}$ ì™€ $\mathfrak{so(3)}$ ë¯¸ë¶„ ê³ ìˆ˜ë˜ëŠ” ë²•" />
<meta property="og:description" content="Single Rotation Averaging ì„ êµ¬í˜„í•´ë³´ì ì–´ë µì§€ ì•Šì•„ìš” $\text{SO(3)}$ ì™€ $\mathfrak{so(3)}$ ë¯¸ë¶„ ê³ ìˆ˜ë˜ëŠ” ë²•" />
<link rel="canonical" href="http://localhost:4000/slam/2024/08/24/rot-avg1.html" />
<meta property="og:url" content="http://localhost:4000/slam/2024/08/24/rot-avg1.html" />
<meta property="og:site_name" content="Giseop Kim Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-24T10:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ğŸŒˆ From-scratched Pose-graph SLAM Tutorial: 1í¸" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Giseop Kim"},"dateModified":"2024-08-24T10:00:00+09:00","datePublished":"2024-08-24T10:00:00+09:00","description":"Single Rotation Averaging ì„ êµ¬í˜„í•´ë³´ì ì–´ë µì§€ ì•Šì•„ìš” $\\text{SO(3)}$ ì™€ $\\mathfrak{so(3)}$ ë¯¸ë¶„ ê³ ìˆ˜ë˜ëŠ” ë²•","headline":"ğŸŒˆ From-scratched Pose-graph SLAM Tutorial: 1í¸","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/slam/2024/08/24/rot-avg1.html"},"url":"http://localhost:4000/slam/2024/08/24/rot-avg1.html"}</script>
<!-- End Jekyll SEO tag -->


<script type="text/javascript" src="/assets/js/darkmode.js"></script>


<!-- fabicon -->
<link rel="icon" type="image/png" href="/assets/icon/me.png">
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
        alert("Math Processing Error: "+message[1]);
    });
MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
        alert("Math Processing Error: "+message[1]);
    });
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
</head><body>
  <main class="container">
    <section class="about">
      <div class="about-header condensed">
      <div class="about-title">
      <a href="/">
        
        <img src="/assets/giseopkim_thermal.png" alt="Giseop Kim" />
        
      </a>
      <h2 id="title">
        <a href="/">Giseop Kim</a>
      </h2>
      </div><p class="tagline">SLAM Engineer</p></div>
      
      <ul class="social about-footer condensed"><a href="https://www.linkedin.com/in/giseop-kim-71683088" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><a href="https://scholar.google.com/citations?user=9mKOLX8AAAAJ&hl=ko&oi=ao" target="_blank">
          <li>
            <i class="ai ai-google-scholar"></i>
          </li>
        </a><a href="https://github.com/gisbi-kim" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://bit.ly/giseopkim" target="_blank">
          <li>
            <i class="fa fa-user" style="font-size: 2.09em;"></i>
            <!-- <i> notion</i> -->
            <!-- <i class="fa fa-user"></i> -->
          </li>
        </a><a href="https://youtube.com/channel/UCrmVMJ3KEFbDD9EtnAmDT6g" target="_blank">
          <li>
            <i class="icon-youtube"></i>
          </li>
        </a></ul><p class="about-footer condensed">&copy;
        2024</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </section>
    <section class="content">
      <div class="post-container">
  <a class="post-link" href="/slam/2024/08/24/rot-avg1.html">
    <h2 class="post-title">ğŸŒˆ From-scratched Pose-graph SLAM Tutorial: 1í¸</h2>
  </a>
  <hr style="border:1px foo rgb(193, 198, 200)">
  <div class="post-meta">
    <div class="post-date"><i class="icon-calendar"></i>Aug 24, 2024</div><ul class="post-categories"><li>SLAM</li></ul></div>
  <div class="post">
    <h1 id="single-rotation-averaging-ì„-êµ¬í˜„í•´ë³´ì">Single Rotation Averaging ì„ êµ¬í˜„í•´ë³´ì</h1>
<ul>
  <li>ì–´ë µì§€ ì•Šì•„ìš”</li>
  <li>$\text{SO(3)}$ ì™€ $\mathfrak{so(3)}$ ë¯¸ë¶„ ê³ ìˆ˜ë˜ëŠ” ë²•</li>
</ul>

<h2 id="ê°œìš”">ê°œìš”</h2>
<ul>
  <li>Rotation averaging ì€ SfM (Structure-from-motion), SLAM ë“±ì—ì„œ ìì£¼ ë“±ì¥í•˜ëŠ” task ì´ë‹¤.
    <ul>
      <li>ps. rotation averaging ì´ ë¬´ì—‡ì¸ì§€ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒ ë…¼ë¬¸ì„ ì°¸ê³ .
        <ul>
          <li><a href="https://users.cecs.anu.edu.au/~hartley/Papers/PDF/Hartley-Trumpf:Rotation-averaging:IJCV.pdf">Rotation Averaging by Richard Hartley, et al.</a></li>
          <li>ì´ ë…¼ë¬¸ì„ ì¸ìš©í•œ ë…¼ë¬¸ë“¤ ì¤‘ ì¸ìš©ìˆ˜ê°€ ë§ì€ ê²ƒì„ ë³´ëŠ” ê²ƒ ë˜í•œ ë„ì›€ì´ ë˜ê² ë‹¤.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ì™œ í•„ìš”í•œê°€?
    <ul>
      <li>ëŒ€ë¶€ë¶„ì˜ geometric computer vision ë¬¸ì œì—ì„œ, residual ì„ ìµœì†Œí™” í•  ë•Œ,</li>
      <li>í˜„ì¬ solutionìœ¼ë¡œë¶€í„° delta ë§Œí¼ ì¡°ê¸ˆì”© ì´ë™í•´ë‚˜ê°€ë©´ì„œ ìµœì¢… solution ìœ¼ë¡œ ìˆ˜ë ´í•´ë‚˜ê°€ëŠ”ë° (i.e., Gauss-Newton),</li>
      <li>ì´ ì‘ì—…ì€ vector space ì—ì„œë§Œ ê°€ëŠ¥í•˜ë¯€ë¡œ,</li>
      <li>nonlinear í•œ term ë“¤ì„ êµ­ì†Œì ìœ¼ë¡œ linearization í•´ì£¼ì–´ì•¼ í•˜ëŠ”ë°,
        <ul>
          <li>ì´ ì´ì•¼ê¸°ì— ëŒ€í•œ ë” ìì„¸í•œ ì„¤ëª…ì€ <a href="/slam/2023/12/17/nano-lie-theory.html">ì˜ˆì „ í¬ìŠ¤íŠ¸</a> ë¥¼ ì°¸ê³ .</li>
        </ul>
      </li>
      <li>ì´ ë•Œ, ì§ì „ solution ì´ ì•ˆ ì¢‹ë‹¤ë©´ (== global solution ìœ¼ë¡œë¶€í„° ë©€ë‹¤ë©´)</li>
      <li>í•´ê°€ ìˆ˜ë ´í•˜ê¸° ì–´ë µë‹¤.</li>
      <li>ì´ê²ƒì´ SfM or SLAM ì—ì„œ ë”ìš± ë¬¸ì œê°€ ë˜ëŠ” ê±´,</li>
      <li>N ê°œì˜ ë…¸ë“œ (ìˆ˜ì‹­ê°œì¼ìˆ˜ë„, ìˆ˜ì²œ ìˆ˜ë§Œ ê°œ ì¼ìˆ˜ë„) ì˜ pose ë¥¼ ëª¨ë‘ joint í•˜ê²Œ ìµœì í™” í•˜ëŠ” ë¬¸ì œë¥¼ í‘¸ëŠ” ê²ƒì´ SfM or SLAM ì¸ë°</li>
      <li>rotation ì´ nonlinear í•œ ìš”ì†Œì´ê³ ,</li>
      <li>Gauss-newton ê³¼ì •ì—ì„œ, rotation ë¶€ë¶„ì˜ current solution ì´ ì•ˆì¢‹ë‹¤ë©´ ì´ëŠ” pose ì¤‘ rotation ì´ ì•„ë‹ˆë¼ position ë¶€ë¶„ì—ë„ ì•…ì˜í–¥ì„ ë¼ì¹  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤ (ê·¸ë¦¬ê³  ë§ˆì°¬ê°€ì§€ë¡œ ê·¸ëŸ¬í•œ í•œ ë…¸ë“œì˜ ì—ëŸ¬ê°€ ë‹¤ë¥¸ ë…¸ë“œë“¤ì—ë„ ì•…ì˜í–¥ì„ ë¼ì¹  ìˆ˜ë„ ìˆê² ë‹¤).</li>
    </ul>
  </li>
  <li>ê·¸ë˜ì„œ, íŠ¹íˆ nonlinear í•œ termì¸ rotation ë¶€ë¶„ì„ global solutionì— ì˜ ë§ê²Œ ì´ˆê¸°ê°’ì„ ì˜ ì„¤ì •í•´ë‘˜ ìˆ˜ ìˆë‹¤ë©´, translation loss ë“±ì€ ë˜í•œ ì‰½ê²Œ í’€ë¦´ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</li>
  <li>ì˜ˆë¥¼ ë“¤ì–´ì„œ, í•˜ë‚˜ì˜ ë…¸ë“œ (pose) ì˜ rotation (attitude) ì— ëŒ€í•œ measurement ê°€ k ê°œ ìˆì„ ë•Œ, ì´ê²ƒì„ ìˆ˜ë§Œê°œ ë…¸ë“œì˜ joint optimization ì„ í’€ ë•Œ ëª¨ë‘ constraint ë¡œ ë„£ì–´ì£¼ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, k ê°œì˜ measurement ë“¤ì„ ì˜ ë¶„ì„í•´ì„œ ì‹ ë¢°í• ë§Œí•œ í•˜ë‚˜ì˜ ê°’ë§Œì„ ë„ì¶œí•œ ë‹¤ìŒ, ê·¸ê²ƒë§Œì„ ì „ì²´ ìµœì í™” ë¬¸ì œì˜ constraint ë¡œ ì¶”ê°€í•´ì¤„ ìˆ˜ ìˆê² ë‹¤.</li>
  <li>ì¦‰, <strong>single rotation averaging</strong> ì´ë¼ëŠ” taskëŠ”,
    <ul>
      <li><strong>í•˜ë‚˜</strong>ì˜ ë…¸ë“œ (pose) ì˜ rotation (attitude) ì— ëŒ€í•œ measurement ê°€ k ê°œ ìˆì„ ë•Œ,</li>
      <li>ì´ ì¸¡ì •ì¹˜ë“¤ì„ ëª¨ë‘ ì ë‹¹íˆ ë§Œì¡±í•˜ë„ë¡ ê³ ë ¤í–ˆì„ ë•Œ,</li>
      <li>ê·¸ ë…¸ë“œì˜ rotation (attitude or orientation ë“±ìœ¼ë¡œë„ ë¶ˆë¦¼) ì€ ê·¸ë˜ì„œ ìµœì¢…ì ìœ¼ë¡œ ë¬´ì—‡ì¸ê°€, ì— ëŒ€í•œ ëŒ€ë‹µì„ í•˜ëŠ” ë¬¸ì œì´ë‹¤.</li>
    </ul>
  </li>
  <li>rotation (i.e., SO(3)) ì€ vector space ì— ì‚´ê³  ìˆì§€ ì•Šê¸° ë•Œë¬¸ì—, ë‹¨ìˆœíˆ xyz ë“¤ì„ k ë¡œ ë‚˜ëˆ„ëŠ”, ì¦‰, $ \textbf{sum}(\textbf{R}_1, \textbf{R}_2, \textbf{R}_3) / 3$ ê³¼ ê°™ì´ ë‚˜ì´ë¸Œí•˜ê²Œ ê³„ì‚°í•  ìˆ˜ëŠ” ì—†ë‹¤.</li>
  <li>ë¬¼ë¡  sum ì´ë¼ëŠ” í•¨ìˆ˜ì™€ / ë¼ëŠ” ë‚˜ëˆ—ì…ˆì„ ì–´ë–»ê²Œ ì •ì˜í• ê±°ëƒì— ë‹¬ë¦°ê²ƒì´ê¸´ í•˜ì§€ë§Œâ€¦ ì—¬ê¸°ì—ì„œ ì´ì•¼ê¸°í•˜ë ¤ê³  í•˜ëŠ” ê²ƒì€ ì €ëŸ° deterministic í•œ ê³„ì‚°ì„ í•œ ë°©ì— í•˜ë ¤ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ëŒ€ì‹ ì— iteratively ì¡°ì •í•´ë‚˜ê°€ëŠ” ê³¼ì •ì„ ì–´ë–»ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠëƒ? í•˜ëŠ” ì ì´ë‹¤. ì¦‰, ì € í‰ê· ì¡°ì°¨ë„ iterative í•˜ê²Œ ì–»ì–´ì ¸ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” ë‹¤ì‹œ ë§í•˜ì§€ë§Œ rotation ì´ ì‚´ê³  ìˆëŠ” ê³µê°„ì€ nonlinear í•˜ê³  êµ­ì†Œì ìœ¼ë¡œ (== iterative optimization ì´ ìˆ˜í–‰ë˜ëŠ” tangent space) ë§Œ vector space ì´ê¸° ë•Œë¬¸ì— ì €ëŸ° ì¼ë°˜ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. 
<!-- - ì¦‰, rotation averaging ì€ ë²ˆì—­ì²´ ê·¸ëŒ€ë¡œ ì´ì•¼ê¸°í•˜ë©´ ì¢€ ì–´ìƒ‰í•  ìˆ˜ë„ ìˆê² ë‹¤. ê·¸ê²ƒì˜ ì˜ë¯¸ëŠ” í‰ê· ì´ê¸°ëŠ” í•˜ì§€ë§Œ, ì‹¤ì œë¡œ ê·¸ê²ƒì´ ì–»ì–´ì§€ëŠ” numerically mechanical í•œ ê³¼ì •ì€ ìµœì í™”ì´ê¸° ë•Œë¬¸ì´ë‹¤. ì¸¡ì •ì¹˜ë“¤ì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” solutionì„ (ìµœì í™”ë¥¼ í†µí•´) êµ¬í•˜ëŠ” ì¼ì´ë¼ê³  í•´ì„í•´ì•¼ í•  ê²ƒì´ë‹¤.  --></li>
  <li>ìœ„ ë…¼ë¬¸ <a href="https://users.cecs.anu.edu.au/~hartley/Papers/PDF/Hartley-Trumpf:Rotation-averaging:IJCV.pdf">Rotation Averaging by Richard Hartley, et al.</a> ì—ì„œëŠ” rotation definitionì„ ë¨¼ì € í•˜ê³ , ìœ ìš©í•œ ì„±ì§ˆë“¤ì— ëŒ€í•´ ì´ì•¼ê¸° í•œ ë’¤, ì—¬ëŸ¬ distance ì— ëŒ€í•´ì„œë„ ë…¼ì˜í•˜ê³ , ë©”ì¸ì—ì„œëŠ” 1. single rotation averaging ê³¼ 2. multiple rotation averaging ì— ëŒ€í•´ ì´ì•¼ê¸°í•œë‹¤.</li>
  <li>ê·¸ ì¤‘, ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” 1. single rotation averaging  ì— ëŒ€í•´ì„œë§Œ ì•Œì•„ë³¼ ê²ƒì´ë‹¤.
    <ul>
      <li>rotation ì˜ ì •ì˜ë‚˜ ê¸°ë³¸ì ì¸ ì„±ì§ˆì— ëŒ€í•´ì„œëŠ” ë…ìê°€ ì•Œê³ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.</li>
      <li>ê·¸ë‚˜ì €ë‚˜ 2. multiple rotation averaging ëŠ” rotation only pose-graph optimization ì´ë¼ê³ ë„ ë¶ˆë¦°ë‹¤.</li>
    </ul>
  </li>
  <li>ê·¸ë¦¬ê³  ìœ„ ë…¼ë¬¸ì„ ë³´ë©´ rotation ì´ ì‚´ê³ ìˆëŠ” ê³µê°„ì—ì„œ distance ë¥¼ ì •ì˜í•˜ëŠ” ë°©ì‹ì´ ì—¬ëŸ¬ ê°œê°€ ìˆìŒì„ ì•Œ ìˆ˜ ìˆëŠ”ë°, ë³¸ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ê°€ì¥ ê¸°ë³¸ì ì´ê³  ì •ì„ì ì¸ tangent space ì—ì„œì˜ L2 loss ë¡œ ì •ì˜í•  ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  ê·¸ ì°¨ì´ë¥¼ iteratively ì¤„ì—¬ë‚˜ê°€ë©´, ì›ë˜ rotation ê³µê°„ (we call it manifold, SO(3)) ì—ì„œë„ ìµœì í™”ê°€ ë˜ì–´ìˆëŠ”ì§€ ë³´ì¼ ê²ƒì´ë‹¤.</li>
</ul>

<h2 id="í‹°ì €">í‹°ì €</h2>
<ul>
  <li>ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ”, single rotation averaging ì„ from scratch ë¡œ êµ¬í˜„í•´ë³´ê³  ì‹¤ìŠµí•´ë³´ì.</li>
  <li>í‹°ì €
    <ul>
      <li>ê²°ê³¼ë¶€í„° ë¨¼ì € ë³´ì´ìë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤.
        <ul>
          <li>ì„¤ëª…
            <ul>
              <li>ë¹¨ê°•, ì²­ë¡, ë…¸ë‘ axes ë“¤ì€, ì–´ë–¤ ë¡œë´‡ì˜ ì–´ë–¤ ì‹œì ì—ì„œì˜ ëŒ€í•œ ìì„¸ (rotation, attitude, orientation ë“±ìœ¼ë¡œ ë¶ˆë¦¼) ì˜ˆì¸¡ ê°’ì„ ì˜ë¯¸í•œë‹¤.
                <ul>
                  <li>ì˜ˆë¥¼ ë“¤ì–´ì„œ ë™ì¼í•œ ì„¼ì„œë¡œ ì„¸ ë²ˆ ì¸¡ì •í–ˆëŠ”ë°, í˜„ì‹¤ì„¸ê³„ì˜ ì„¼ì„œë€ noisy í•˜ê³  ë¶ˆì™„ì „í•˜ë¯€ë¡œ ì¡°ê¸ˆì”© ì €ë ‡ê²Œ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆê² ë‹¤.</li>
                </ul>
              </li>
              <li>ê·¸ëŸ¬ë©´ ì € ì…‹ ì •ë³´ë¥¼ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” (== ê°œë…ì ìœ¼ë¡œ í‰ê· , ì‹¤ì œ ê³„ì‚°ì€ iterative optimization) ê°’ì„ êµ¬í•´ì„œ, ë¡œë´‡ì˜ ìì„¸ëŠ” ì´ê²ƒì´ì•¼! ë¼ê³  ë§í•´ì•¼ í• í…ë°,</li>
              <li>ê·¸ ê²°ê³¼ëŠ” íŒŒë‘ìƒ‰ ì¶•ì´ë‹¤.</li>
              <li>ì¼ë‹¨ ì‚¬ëŒì´ ì‹œê°ì ìœ¼ë¡œ ë³´ì•˜ì„ ë•Œ ë§ì´ ë§ëŠ” ê²ƒ ê°™ì•„ë³´ì¸ë‹¤. íŒŒë‘ì´ ì„¸ ì¶• ëª¨ë‘ì—ì„œ, ë‹¤ë¥¸ ì…‹ ë“¤ì˜ ì¤‘ê°„ ì¦ˆìŒì— ìœ„ì¹˜í•˜ëŠ” ê²ƒì„ ì˜ ë³¼ ìˆ˜ ìˆë‹¤.</li>
            </ul>
          </li>
          <li>ì–´ë–»ê²Œ êµ¬í˜„í–ˆëŠ”ì§€ ì´ì œ ì°¨ì°¨ ì„¤ëª…ì„ í•´ë³´ì.</li>
        </ul>
      </li>
    </ul>
    <figure id="onmanifold_gaussnewton_result" align="center">
      <img src="/assets/data/2024-08-24-rot-avg1/main_onmanifold_ganussnewton_result.png" width="800" />
      <figcaption>On-manifold Gauss-Newton Result</figcaption>
  </figure>
  </li>
</ul>

<h2 id="ë°°ê²½ì§€ì‹-1">ë°°ê²½ì§€ì‹ 1</h2>
<ul>
  <li>ì¼ë‹¨ iterative optimization ì˜ ê¸°ê³„ì ì¸ ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ë‹¤ (ì´ê±¸ ë‚˜ëŠ” ê°œì¸ì ìœ¼ë¡œ â€˜ê¸°ê³„ì ì¸ ê³¼ì •â€™ ì´ë¼ë˜ê°€, â€˜ì‚°ìˆ˜â€™ ë¼ë˜ê°€, â€˜ê³„ì‚°ê¸°â€™ë¼ê³  ë¶€ë¥¸ë‹¤. ì¦‰, ì–´ë µì§€ ì•Šë‹¤ëŠ” ë§ì´ë‹¤).
    <ul>
      <li>ì´ ê·¸ë¦¼ì€ ë§¤ë²ˆ ì¶”ì²œí•˜ëŠ” ìë£Œì¸, <a href="http://www.diag.uniroma1.it/~labrococo/tutorial_icra_2016/">ICRA 2016 SLAM tutorial</a> ì¤‘, <a href="http://www.diag.uniroma1.it/~labrococo/tutorial_icra_2016/icra16_slam_tutorial_grisetti.pdf">Giorgio Grisetti êµìˆ˜ë‹˜ ìŠ¬ë¼ì´ë“œ</a> ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.</li>
    </ul>
    <figure id="gn_manifold" align="center">
      <img src="/assets/data/2024-08-24-rot-avg1/gn_manifold.png" width="600" />
      <figcaption>GN Manifold Diagram</figcaption>
  </figure>
  </li>
  <li>ì—¬ê¸°ì„œ $\textbf{J}$ ë§Œ êµ¬í•˜ë©´ ëœë‹¤.
    <ul>
      <li>ps. ë‚´ê°€ ë‹¤ë£¨ëŠ” 1. ì„¼ì„œ íŠ¹ì„± (ì˜ˆ: ì¹´ë©”ë¼ëŠ” pixel ë¡œ êµ¬ì„±ë˜ì–´ìˆê³  ì„¸ìƒì˜ ì •ë³´ê°€ projective í•˜ê²Œ ìƒì„±ëœë‹¤) ê³¼, 2. ê·¸ ì„¼ì„œ íŠ¹ì„±ì„ ê³ ë ¤í•œ observation model (residual model) (ì˜ˆ: ê·¸ëŸ¬ë¯€ë¡œ pose ê°€ trueì˜€ë‹¤ë©´ projection í–ˆì„ ë•Œì˜ reprojection error ê°€ ì‘ì„ ê²ƒì´ë‹¤. ê·¸ê²ƒì€ (u, v) ê³µê°„ì—ì„œì˜ ê·¸ì € ë‘ ì°¨ì› ë²¡í„°ì˜ ëº„ì…ˆìœ¼ë¡œ ì •ì˜ëœë‹¤), ì´ ë‘ ê°€ì§€ë¥¼ ì–´ë–»ê²Œ ì˜ ì•Œê³  ì˜ ë‹¤ë£¨ê³  ì˜ êµ¬í˜„í•  ìˆ˜ ìˆëŠëƒê°€ ë‹¨ìˆœíˆ geometric vision ì „ê³µìë¥¼ ë„˜ì–´ì„œì„œ SLAM engineerì˜ ë„ë©”ì¸ ë†€ë¦¬ì§€ë¼ê³  í•  ìˆ˜ ìˆê² ë‹¤.</li>
      <li>Jê°€ ì–´ë–»ê²Œ êµ¬í•´ì§€ëŠëƒë§Œ ë‹¤ë¥´ì§€, ê·¸ ì´í›„ê³¼ì •ì€ ëª¨ë“  ë…¼ë¬¸ë“¤ì´ ë™ì¼í•˜ë‹¤.</li>
    </ul>
  </li>
</ul>

<h2 id="ë°°ê²½ì§€ì‹-2">ë°°ê²½ì§€ì‹ 2</h2>
<ul>
  <li>$\textbf{J}$ â€¦</li>
  <li>ìì½”ë¹„ì•ˆ, ì•¼ì½”ë¹„ì•ˆ, â€¦ ë‹¤ì–‘í•˜ê²Œ ë¶ˆë¦¬ëŠ” ì´ ë…€ì„
    <ul>
      <li>ê·¸ëƒ¥ multi-dimensional ê¸°ìš¸ê¸°ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.</li>
      <li>Gauss-Newton optimization ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ê¸°ìš¸ê¸° ê°’ì„ ì•Œì•„ì•¼ í•˜ê¸° ë•Œë¬¸.</li>
      <li><a href="/slam/2024/05/25/reprojection-jacobian-r2live.html">ì˜ˆì „ í¬ìŠ¤íŠ¸</a> ì—ì„œë„ ì´ ì–˜ê¸°ëŠ” ì´ë¯¸ í–ˆì—ˆë‹¤ (ì‚¬ì‹¤ ê²°êµ­ ë§¨ë‚  ì´ ì–˜ê¸°ë¥¼ í•˜ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤ â€¦).
        <ul>
          <li>ì—¬ê¸°ì„œë„ ë‹¤ì‹œ ë§í•˜ìë©´, ìì½”ë¹„ì•ˆì€ ì´ë ‡ê²Œ ê¸°ì–µí•˜ë©´ ëœë‹¤. matrix ë„¤ëª¨ì˜ ì„¸ë¡œ(ì¦‰, row ë“¤) ëŠ” cost, ê°€ë¡œ(ì¦‰, columnë“¤)ëŠ” state.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ì•„ë¬´íŠ¼ ë³¸ í¬ìŠ¤íŠ¸ì—ì„œë„ ê²°êµ­, ì–´ë–¤ residual functionì— ëŒ€í•œ, ìµœì  rotation ì˜ ë¯¸ì†Œë³€í™”ëŸ‰, ì˜ ë¯¸ë¶„ matrix (== ìì½”ë¹„ì•ˆ) ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ê´€ê±´ì´ ëœë‹¤.</li>
  <li>rotation ì— ëŒ€í•´ í•´ë³´ì.</li>
</ul>

<h2 id="ìœ ë„-ê³¼ì •-derivation">ìœ ë„ ê³¼ì • (Derivation)</h2>
<ul>
  <li>iterative í•˜ê²Œ an averaged rotation ê°’ì„ ì˜ˆì¸¡í•  ê²ƒì´ë¯€ë¡œ,</li>
  <li>í˜„ì¬ ($t$ ë²ˆì§¸ step) ê¹Œì§€ ì˜ˆì¸¡ëœ ê°’ì„ $\textbf{R}^{(t)}$ ì´ë¼ê³  í•´ë³´ì.
    <ul>
      <li>== <a href="#onmanifold_gaussnewton_result">ìœ„ì˜ í‹°ì € ê·¸ë¦¼</a>ì—ì„œ íŒŒë‘ í™”ì‚´í‘œ (í˜¹ì€ ì´ê²ƒì— ë„ë‹¬í•˜ê¸° ì „ì˜ ìŠ¤í…)</li>
    </ul>
  </li>
  <li>ê·¸ë¦¬ê³  ì–´ë–¤ measurement $\textbf{R}_1$, $\textbf{R}_2$, $\textbf{R}_3$ ì´ë ‡ê²Œ 3ê°œê°€ ìˆì—ˆë‹¤ê³  í•˜ì.
    <ul>
      <li>== <a href="#onmanifold_gaussnewton_result">ìœ„ì˜ í‹°ì € ê·¸ë¦¼</a>ì—ì„œ íŒŒë‘ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ í™”ì‚´í‘œë“¤</li>
    </ul>
  </li>
  <li>ê·¸ëŸ¬ë©´, ì´ ì„¸ ê°œì˜ measurement ë¡œë¶€í„° ê°ê° $\textbf{H}_i$ ì™€ $\textbf{e}_i$ ê°€ ìƒì„±ë˜ê³ ,</li>
  <li>ì „ì²´ $\textbf{H}$ ì™€ $\textbf{b}$ ëŠ” <a href="#gn_manifold">ì•ì„œ ì†Œê°œí•œ tutorial slide</a> ì—ì„œ ì„¤ëª…í•œëŒ€ë¡œ (ë‹¨ìˆœí•œ ë§ì…ˆìœ¼ë¡œ!) ì–»ì–´ì§€ê²Œ ëœë‹¤.
    <ul>
      <li>ì½”ë“œë¡œë„ ë‹¹ì—°íˆ ë„ˆë¬´ ê°„ë‹¨í•˜ë‹¤.
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">H</span> <span class="o">+=</span> <span class="n">J_i</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">J_i</span> 
  <span class="n">b</span> <span class="o">+=</span> <span class="n">J_i</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">e_i</span> 
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>ê·¸ëŸ¼ ìš°ë¦¬ê°€ ì§€ê¸ˆ ìœ ë„í•˜ë ¤ëŠ” ê²ƒì€ ê²°êµ­ ì € <code class="language-plaintext highlighter-rouge">J_i</code> ì™€ <code class="language-plaintext highlighter-rouge">e_i</code> ê°€ ë¬´ì—‡ì¸ê°€ í•˜ëŠ” ê²ƒì´ë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">J_i</code> ëŠ” <code class="language-plaintext highlighter-rouge">e_i</code>ë¥¼ ë¯¸ë¶„í•¨ìœ¼ë¡œì¨ ì–»ì–´ì§€ëŠ” ê²ƒì´ë¯€ë¡œ, ë¨¼ì € <code class="language-plaintext highlighter-rouge">e_i</code> ë¥¼ ì •ì˜í•´ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">e_i</code>ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
    <ul>
      <li>ìš°ë¦¬ëŠ” iteratively gauss newton optimization ì„ ìˆ˜í–‰í•  ê²ƒì´ë¯€ë¡œ</li>
      <li>ê·¸ ìµœì ì¡°ê¸ˆì›€ì§ì„ í•´ëŠ” rotation ì˜ tangent space ì—ì„œë§Œ ì •ì˜ê°€ ê°€ëŠ¥í•˜ë‹¤. ê±°ê¸°ë§Œì´ vector spaceì´ê¸° ë•Œë¬¸ì´ë‹¤.
        <ul>
          <li>ì´ ë§ì´ ì´í•´ê°€ ê°€ì§€ ì•ŠëŠ”ë‹¤ë©´ ì˜ˆì „ í¬ìŠ¤íŠ¸ë¥¼ ì½ê³  ì˜¤ê¸°ë¥¼ ì¶”ì²œí•œë‹¤. <a href="/slam/2023/12/17/nano-lie-theory.html">ì˜ˆì „ í¬ìŠ¤íŠ¸1</a> ì™€ <a href="/slam/2024/05/25/reprojection-jacobian-r2live.html">ì˜ˆì „ í¬ìŠ¤íŠ¸2</a>.</li>
        </ul>
      </li>
      <li>ì›ë˜ì˜ rotation ê³µê°„ì¸ $\mathrm{SO(3)}$ ì—ì„œì˜ residual (ì€ 3 by 3 matrix ì´ë‹¤) ì— $\textbf{Log}(\cdot)$ ì—°ì‚°ì„ ì·¨í•´ì£¼ë©´ 3-dim vectorê°€ ìƒì„±ëœë‹¤.</li>
      <li>ê·¸ê²ƒì´ ìš°ë¦¬ì˜ <code class="language-plaintext highlighter-rouge">e_i</code>ê°€ ëœë‹¤.</li>
      <li>ì™œ ê·¸ë ‡ê²Œ í•˜ëƒê³  ë¬»ëŠ”ë‹¤ë©´, ë‹¤ì‹œ ìš”ì•½í•˜ìë©´, Gauss-Newton opt ëŠ” vector space ì—ì„œë§Œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ë°, ê·¸ê²ƒì€ $\mathrm{SO(3)}$ ì˜ tangent spaceì¸ $\mathfrak{so(3)}$ ì—ì„œ ì •ì˜ëœë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” $\mathrm{SO(3)}$ ì—ì„œ distance ë¥¼ êµ¬í•˜ê³ , ê±°ê¸°ì— $\textbf{Log}(\cdot)$ ì—°ì‚°ì„ ì·¨í•´ì„œ, $\mathfrak{so(3)}$ ìƒì—ì„œì˜ distance ë¥¼ ì •ì˜í–ˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.
        <ul>
          <li>ps. ì™œ $\textbf{Log}(\cdot)$ ì—°ì‚°ì„ ì·¨í•´ì•¼, $\mathfrak{so(3)}$ ìƒì—ì„œì˜ distance ê°€ ë˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ì—¬ê¸°ì—ì„œ ë” ì„¤ëª…í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ê·¸ê²ƒì€ ì•½ê°„ ê¸°ë³¸ì´ê¸° ë•Œë¬¸â€¦ ì—¬ê¸°ì„œë¶€í„°ëŠ” <a href="https://arxiv.org/abs/1711.02508">Quaternion kinematics for the error-state Kalman filter</a> ì´ë‚˜, ì•„ë‹ˆë©´ ë‹¤ë¥¸ ë…¼ë¬¸ë“¤ì„ ì°¸ê³  ë°”ëŒ.</li>
        </ul>
      </li>
      <li>ê·¸ë¦¬ê³  $\textbf{Log}(\cdot)$ ëŠ” ì‚¬ì‹¤ $\textbf{log}(\cdot)$ ë¼ëŠ” ì—°ì‚°ì— unskew ë¥¼ í•´ì£¼ëŠ” ê³¼ì •ì„ ë”í•œ ê²ƒì„, ê°„ë‹¨í•˜ê²Œ ë¬¸ìë¡œ í‘œí˜„í•˜ë ¤ê³  lì„ Lë¡œë§Œ ë°”ê¿”ì“´ê²ƒì´ë‹¤.</li>
    </ul>
  </li>
  <li>ê·¸ëŸ¼ ì´ì œê¹Œì§€ tangent space ìƒì—ì„œì˜ error function (our observation model) ì„ ì •ì˜í–ˆìœ¼ë‹ˆ, ì´ê²ƒì˜ Jacobianì„ êµ¬í•´ë³´ì.</li>
  <li>ë¨¼ì €, <code class="language-plaintext highlighter-rouge">e_i</code>ì˜ ìˆ˜ì‹ì„ ì½”ë“œê°€ ì•„ë‹ˆë¼ latexìœ¼ë¡œ ë‹¤ì‹œ ì ì–´ë³´ì.
    <ul>
      <li>$e_i = \textbf{Log}(error(\mathbf{R}))$ ì´ê³ , ì—¬ê¸°ì„œ $error(\mathbf{R})$ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤. $error(\mathbf{R}) = \mathbf{R}_{\text{measurement}} \ominus \mathbf{R}_{\text{estimated}} = \mathbf{R}_{\text{estimated}}^\top \cdot \mathbf{R}_{\text{measurement}}$
        <ul>
          <li>ì™œ transpose ì˜ ì™¼ìª½ê³±ì´ ë˜ëŠ”ì§€ ê¹Œì§€ ì—¬ê¸°ì„œ ì„¤ëª…í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤..</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ì•ì„œ ìš°ë¦¬ì˜ measurement ë¥¼ ê°„ë‹¨íˆ $\mathbf{R}_{i}$ ë¼ ë¶ˆë €ê³  (ì˜ˆ: $\mathbf{R}_{1}$, $\mathbf{R}_{2}$, $\mathbf{R}_{3}$), ìš°ë¦¬ì˜ (step $t$ì—ì„œì˜) ì˜ˆì¸¡ê°’ì„ $\mathbf{R}^{(t)}$ë¼ê³  ë¶ˆë €ìœ¼ë‹ˆ, ë‹¤ì‹œ ì‹ì„ ì¨ë³´ë©´</li>
  <li>$e_i = \textbf{Log}({\mathbf{R}^{(t)}}^\top \cdot \mathbf{R}_{i})$ ë¼ê³  í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì´ì œ $\mathbf{J}_i$ë¥¼ ë…¼í•  ìˆ˜ ìˆë‹¤.</li>
  <li>$\mathbf{J}_i$ëŠ”, ìš°ë¦¬ì˜ ê´€ì‹¬ì‚¬(ìµœì ì¡°ê¸ˆì›€ì§ì„ê°’ì´ ì–¼ë§ˆì¸ì§€)ì¸ tangent space ì—ì„œì˜ value (rotation vector ë¼ê³  í•˜ì) ì¸, ì´ 3-dim vectorì¸ ì´ ê°’ì´ ì¡°ê¸ˆ ì›€ì§ì¼ ë•Œ, ìœ„ì˜ $e_i$ê°€ ì–¼ë§ˆë‚˜ ë³€í•˜ëŠ”ì§€? ë¡œ ì •ì˜ëœë‹¤.</li>
  <li>ê·¸ ìµœì ìœ¼ë¡œ ì¡°ê¸ˆ ì›€ì§ì¸ rotation vector ë¥¼ $\delta \boldsymbol{\theta}$ë¼ê³  í•˜ë©´, (ps. ì¡°ê¸ˆì´ë¼ëŠ” ì˜ë¯¸ì—ì„œ $\delta$ ë¥¼ ë¶™ì„)</li>
  <li>ì´ ë•Œ (== step $t$ì—ì„œ ì¡°ê¸ˆë§Œ ìµœì ìœ¼ë¡œ ë” ì›€ì§ì—¬ ë³¸)ì˜, ì˜ˆì¸¡ ê°’ì€ ${(\mathbf{R}^{(t)} \oplus \delta\boldsymbol{\theta})}$ ê°€ ë˜ê³ ,</li>
  <li>$e_i$ëŠ” ë”°ë¼ì„œ $\textbf{Log}({(\mathbf{R}^{(t)} \oplus \delta\boldsymbol{\theta})}^\top \cdot \mathbf{R}_{i})$ ê°€ ë˜ë©°,
    <ul>
      <li>ps. ì´ ë•Œ $\oplus$ë€ matmul ì„ ì˜ë¯¸í•œë‹¤. í•˜ì§€ë§Œ ì™œ ê·¸ë ‡ê²Œ ì“°ë‚˜ë©´, $\delta\boldsymbol{\theta}$ ëŠ” vector ì´ê³ , rotation matrix ê°€ ì‚´ê³ ìˆëŠ” SO(3) ì— ì‚´ê³ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì—, ì¼ë°˜ì ì¸ ë”í•˜ê¸°ë‚˜ ê³±í•˜ê¸° (i.e., $\cdot$) ê¸°í˜¸ë¥¼ ì“°ë©´ ë…¼ë¦¬ê°€ ë§ì§€ì•Šê²Œ ë˜ì–´ í¸ì˜ìƒ $\oplus$ ë‚˜ $\boxplus$ì™€ ê°™ì€ ê¸°í˜¸ë¡œ í‘œê¸°í•˜ëŠ” í’ìŠµì´ ìˆë‹¤. ì‹¤ì œë¡œëŠ” oplus ê°€ ì í˜€ìˆë‹¤ë©´, rotation vector ì— Expë¥¼ ì·¨í•œ ë’¤ matmul ì„ í•´ì¤€ë‹¤ ë¼ê³  ì´í•´í•˜ë©´ ëœë‹¤.
        <ul>
          <li>ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë‹¤ì–‘í•œ ê³µë¶€ìë£Œë“¤ë¡œ ê·¸ ì„¤ëª…ì„ ëŒ€ì‹ í•œë‹¤.
            <ul>
              <li><a href="https://arxiv.org/pdf/1107.1119">Integrating Generic Sensor Fusion Algorithms with Sound State Representations through Encapsulation of Manifolds</a></li>
              <li><a href="https://ingmec.ual.es/~jlblanco/papers/jlblanco2010geometry3D_techrep.pdf">A tutorial on SE(3) transformation parameterizations and on-manifold optimization</a></li>
              <li><a href="https://xipengwang.github.io/lie-theory/#$\boxplus$-and-$\boxminus$">Lie Theory for State Estimation in Robotics</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>$J_i = \frac{\partial e_{i}(\delta \boldsymbol{\theta})}{\partial \delta\boldsymbol{\theta}} = \frac{\partial \textbf{Log}({(\mathbf{R}^{(t)} \oplus \delta\boldsymbol{\theta})}^\top \cdot \mathbf{R}_{i})}{\partial \delta\boldsymbol{\theta}}$ ê°€ ëœë‹¤.</li>
  <li>ì´ê²ƒì´ ì‹¤ì œë¡œ ì½”ë“œìƒìœ¼ë¡œ ì–´ë–»ê²Œ êµ¬í˜„ì´ ë˜ëŠ”ì§€, symforce ë“±ì— ë§¡ê²¨ë„ ë˜ê² ì§€ë§Œâ€¦</li>
  <li>ìš°ë¦¬ê°€ ì•Œê³  ìˆëŠ” rotation ì˜ ìœ ìš©í•œ ìˆ˜ì‹ë“¤ì„ ì˜ ì¡°í•©í•´ì„œ, ì˜ í’€ì–´ì„œ deterministic í•˜ê²Œ ì¨ë‚´ë©´ (== ì½”ë“œë¡œ ì˜®ê¸°ê¸° ì‰¬ìš´ í˜•íƒœ) ìš°ë¦¬ì˜ ëª©í‘œ ë‹¬ì„±ì´ë‹¤.</li>
  <li>íŠ¸ë¦­ 1
    <ul>
      <li>${\mathbf{R}^{(t)} \oplus \delta\boldsymbol{\theta}}$ ì€</li>
      <li>$\mathbf{R}^{(t)} \cdot \textbf{Exp}(\delta\boldsymbol{\theta})$ ì¸ë°,
        <ul>
          <li>ì—¬ê¸°ì„œ, $\delta\boldsymbol{\theta}$ ê°€ ì‘ì€ ê°’ì¼ ë•ŒëŠ” (ìµœì  â€˜ì¡°ê¸ˆâ€™ì›€ì§ì„ ê°’ì´ë¯€ë¡œ ì´ë ‡ê²Œ ê°€ì •í•  ìˆ˜ ìˆìŒ)</li>
          <li>$\textbf{Exp}(\delta\boldsymbol{\theta}) \sim \textbf{I} + [\delta\boldsymbol{\theta}]_{\times}$ ë¡œ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤.
            <ul>
              <li>note: $[ â€¦ ]_{\times}$ ëŠ” inputì´ 3-dim vectorì´ê³ , outputì´ skew symmetric matrix ì¸ í•¨ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>ê·¸ëŸ¬ë©´ ë‹¤ì‹œ, $\mathbf{R}^{(t)} \cdot \textbf{Exp}(\delta\boldsymbol{\theta}) = \mathbf{R}^{(t)} \cdot (\textbf{I} + [\delta\boldsymbol{\theta}]_{\times})$ ê°€ ëœë‹¤.</li>
    </ul>
  </li>
  <li>ê·¸ëŸ¬ë©´ $J_i = \frac{\partial \textbf{Log}({(\mathbf{R}^{(t)} \oplus \delta\boldsymbol{\theta})}^\top \cdot \mathbf{R}_{i})}{\partial \delta\boldsymbol{\theta}}$ ëŠ”
    <ul>
      <li>$J_i = \frac{\partial \textbf{Log}({ (\mathbf{R}^{(t)} \cdot (\textbf{I} + [\delta\boldsymbol{\theta}]_{\times})) }^\top \cdot \mathbf{R}_{i})}{\partial \delta\boldsymbol{\theta}}$ ì™€ ê°™ì´ ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li>íŠ¸ë¦­ 2
    <ul>
      <li>$\textbf{Log}(\cdot)$ ì—°ì‚°ìë¥¼ $\text{unskew}(\textbf{log}(\cdot))$ ì´ë ‡ê²Œ ë‚˜ëˆ ì„œ ì“¸ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ unskew ë¼ëŠ” ë§ì€ ê·¸ëƒ¥ í¸ì˜ìƒ ë‚´ê°€ ë¶™ì¸ ë§ì´ë©° (ì¢€ ë” ì½”ë“œ ì¹œí™”ì ìœ¼ë¡œ ì„¤ëª…í•˜ê¸° ìœ„í•´ì„œ), ì‹¤ì œë¡œëŠ” ìŠ¤íì‹œë©”íŠ¸ë¦­ í–‰ë ¬ì„ ë²¡í„°ë¡œ ë‹¤ì‹œ ë³€í™˜í•˜ëŠ” ì—°ì‚°ì„ â€œveeâ€ ì—°ì‚°ì´ë¼ê³  í”íˆ ë¶€ë¥¸ë‹¤. $\vee$ ê¸°í˜¸ë¡œ ì“´ë‹¤.</li>
      <li>ê·¸ëŸ¬ë©´ $J_i = \frac{\partial \texttt{vee}(\textbf{log}({ (\mathbf{R}^{(t)} \cdot (\textbf{I} + [\delta\boldsymbol{\theta}]_{\times})) }^\top \cdot \mathbf{R}_{i}))}{\partial \delta\boldsymbol{\theta}}$ ì™€ ê°™ì´ ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li>íŠ¸ë¦­ 3
    <ul>
      <li>$(AB)^\top = B^\top \cdot A^\top$ ì„ ì´ìš©í•´ì„œ, $\textbf{log}(\cdot)$ ì•ˆì˜ ì‹ì„ ì •ë¦¬í•˜ë©´</li>
      <li>$\left( \mathbf{R}^{(t)} \cdot (\mathbf{I} + [\delta\boldsymbol{\theta}]_\times) \right)^\top = (\mathbf{I} + [\delta\boldsymbol{\theta}]_\times)^\top \cdot (\mathbf{R}^{(t)})^\top$ ê°€ ëœë‹¤.</li>
    </ul>
  </li>
  <li>íŠ¸ë¦­ 4
    <ul>
      <li>skew-symmetric matrixì˜ ì •ì˜ë¥¼ ì‚¬ìš©í•˜ë©´, $([\delta\boldsymbol{\theta}]_\times)^\top = -[\delta\boldsymbol{\theta}]_\times$ ì´ë‹¤.</li>
      <li>ê·¸ë¦¬ê³  $(A + B)^\top = A^\top + B^\top$  ì´ë¯€ë¡œ</li>
      <li>ìœ„ì˜ í…€ $\left( \mathbf{R}^{(t)} \cdot (\mathbf{I} + [\delta\boldsymbol{\theta}]_\times) \right)^\top = (\mathbf{I} + [\delta\boldsymbol{\theta}]_\times)^\top \cdot (\mathbf{R}^{(t)})^\top$ ì€ $ = (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times) \cdot (\mathbf{R}^{(t)})^\top$ ê°€ ëœë‹¤.</li>
      <li>ì´ì œ ê·¸ëŸ¬ë©´ residual ì‹ì€ $e_i(\delta\boldsymbol{\theta}) = \textbf{Log}\left( (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times) \cdot (\mathbf{R}^{(t)})^\top \cdot \mathbf{R}_i \right)$ ê°€ ëœë‹¤.</li>
    </ul>
  </li>
  <li>íŠ¸ë¦­ 5
    <ul>
      <li>ì—¬ê¸°ì„œ $\mathbf{E} = (\mathbf{R}^{(t)})^\top \cdot \mathbf{R}_i$ ë¼ê³  í•  ë•Œ,</li>
      <li>ìµœì í™” ê³¼ì •ì—ì„œ í˜„ì¬ ì¶”ì •ì¹˜ $\mathbf{R}^{(t)}$ëŠ” ì¸¡ì •ì¹˜ $\mathbf{R}_i$ì— ê·¼ì ‘í•˜ë¯€ë¡œ $\mathbf{E}$ëŠ” ë‹¨ìœ„ í–‰ë ¬ì— ê·¼ì ‘í•œë‹¤.
        <ul>
          <li>ì¦‰, $\mathbf{E} \sim \mathbf{I}$ ë¼ê³  í•  ìˆ˜ ìˆë‹¤.</li>
        </ul>
      </li>
      <li>ë”°ë¼ì„œ:
        <ul>
          <li>$e_i(\delta\boldsymbol{\theta}) = \textbf{Log}\left( (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times) \cdot \mathbf{E} \right) = \texttt{vee}(\textbf{log}\left( (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times) \cdot \mathbf{E} \right)) = \texttt{vee}(\textbf{log}\left( (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times)  \right))$ ë¡œ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>íŠ¸ë¦­ 5
    <ul>
      <li>í…Œì¼ëŸ¬ ì „ê°œë¥¼ ì´ìš©í•˜ì</li>
      <li>$\textbf{log}(\mathbf{I} + \mathbf{A}) = \mathbf{A} - \frac{1}{2}\mathbf{A}^2 + \frac{1}{3}\mathbf{A}^3 - \cdots$ ì´ë‹¤.</li>
      <li>2ì°¨ í•­ ì´ìƒì€ ì‘ìœ¼ë¯€ë¡œ ë¬´ì‹œí•˜ë©´,</li>
      <li>$\textbf{log}\left( (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times)  \right) \sim - [\delta\boldsymbol{\theta}]_\times$ ì´ë‹¤.</li>
    </ul>
  </li>
  <li>ê²°ë¡ 
    <ul>
      <li>ë”°ë¼ì„œ $J_i = \frac{\partial e_{i}(\delta \boldsymbol{\theta})}{\partial \delta\boldsymbol{\theta}} = \frac{\partial \textbf{Log}({(\mathbf{R}^{(t)} \oplus \delta\boldsymbol{\theta})}^\top \cdot \mathbf{R}_{i})}{\partial \delta\boldsymbol{\theta}} = \frac{\partial \texttt{vee}(\textbf{log}\left( (\mathbf{I} - [\delta\boldsymbol{\theta}]_\times)  \right))}{\partial \delta\boldsymbol{\theta}} = \frac{\partial \texttt{vee}(- [\delta\boldsymbol{\theta}]_\times)}{\partial \delta\boldsymbol{\theta}} = \frac{\partial \texttt{unskew}(- \texttt{skew}(\delta\boldsymbol{\theta}))}{\partial \delta\boldsymbol{\theta}} = \frac{\partial (- \delta\boldsymbol{\theta})}{\partial \delta\boldsymbol{\theta}}  = -\mathbf{I} $ ê°€ ëœë‹¤.
        <ul>
          <li>ps. $\texttt{vee}$ ì™€ $\texttt{unskew}$ ëŠ” ê°™ì€ í‘œí˜„ì´ë‹¤. skew ì‘ì—…ì„ ì—­ìœ¼ë¡œ í•´ì¤€ë‹¤ëŠ” ì˜ë¯¸ì—ì„œ ì½”ë“œì—ì„œëŠ” unskew ë¼ê³  ì ëŠ”ê²Œ ì¢€ ë” ì´í•´ê°€ ì‰¬ì›Œì„œ ê·¸ë ‡ê²Œ í‘œí˜„í•´ë³´ì•˜ë‹¤.  ë§ˆì°¬ê°€ì§€ë¡œ $[\cdot ]_\times$ ë¼ëŠ” í‘œí˜„ë³´ë‹¤ëŠ” $\texttt{skew}$ ë¼ê³  ì ìœ¼ë©´ ì¢€ ë” ì§ì´ ë§ëŠ” ë“¯í•œ ëŠë‚Œì´ë‹¤ (ì½”ë“œ ë ˆë²¨ì—ì„œ ë” ì¢‹ì€ ê°€ë…ì„± ë³´ìœ  ê°€ëŠ¥).</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="êµ¬í˜„">êµ¬í˜„</h2>
<ul>
  <li>ì§€ê¸ˆê¹Œì§€ e ì™€ Jë¥¼ êµ¬í–ˆë‹¤.</li>
  <li>ë”°ë¼ì„œ ì½”ë“œë ˆë²¨ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë§¤ìš° ê°„ë‹¨í•˜ë‹¤.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1"># Initialized at the first step's solution
</span>  <span class="n">R_optimal</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># e.g., = R1 
</span>
  <span class="c1"># Gauss-newton update 
</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">max_iters</span><span class="p">):</span>
      <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        
      <span class="c1"># gather measurements 
</span>      <span class="k">for</span> <span class="n">R_i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span><span class="p">]:</span>
          <span class="n">e_i</span> <span class="o">=</span> <span class="nf">unskew</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">R_optimal</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">R_i</span><span class="p">)))</span> 
          <span class="n">J_i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> 

          <span class="n">H</span> <span class="o">+=</span> <span class="n">J_i</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">J_i</span> 
          <span class="n">b</span> <span class="o">+=</span> <span class="n">J_i</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">e_i</span> 
        
      <span class="c1"># solve the normal equation H * dtheta = -b 
</span>      <span class="n">dtheta_optimal</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span>
        
      <span class="c1"># check termination condition (convergenceness)
</span>      <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">iter </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">: dtheta: </span><span class="si">{</span><span class="n">dtheta</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">dtheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
          <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">The solution converged. terminate the GN opt at iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
          <span class="k">break</span>
        
      <span class="c1"># update the solution 
</span>      <span class="n">R_optimal</span> <span class="o">=</span> <span class="n">R_optimal</span> <span class="o">@</span> <span class="nc">Exp</span><span class="p">(</span><span class="n">dtheta_optimal</span><span class="p">)</span>

      <span class="c1"># (optional) ì—…ë°ì´íŠ¸ í•œ SO(3) ê°€ ì •ì˜ë¥¼ ë§Œì¡±í•˜ë„ë¡ ê°•ì œ (make det = 1)
</span>      <span class="n">U</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">R0</span><span class="p">)</span>
      <span class="n">R0</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">det</span><span class="p">(</span><span class="n">R0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">U</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
          <span class="n">R0</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span>

</code></pre></div>    </div>
  </li>
</ul>

<h2 id="ê²°ë¡ ">ê²°ë¡ </h2>
<ul>
  <li>ì½”ë“œì—ì„œ ë§ˆì§€ë§‰ì— <code class="language-plaintext highlighter-rouge"># update the solution</code> ë¶€ë¶„ì—ì„œ, tangent spaceì—ì„œ ì–»ì€ ìµœì ì¡°ê¸ˆì›€ì§ì„ ê°’ì„ ì›ë˜ rotationì— ì²¨ê°€í•´ì£¼ëŠ” ê²ƒì„ â€œretractâ€ operation ì´ë¼ê³  ë¶€ë¥¸ë‹¤. ì „ì²´ ê³¼ì •ì€ lift-solve-retract pipeline ì´ë¼ê³  ë¶ˆë¦¬ê¸°ë„ í•œë‹¤. <a href="/slam/2023/12/17/nano-lie-theory.html">ì˜ˆì „ í¬ìŠ¤íŠ¸</a> ì—ì„œ ì–¸ê¸‰í•´ë‘ì—ˆìŒ.</li>
  <li><a href="https://arxiv.org/abs/1512.02363">2016 T-RO Paper ì¸ On-Manifold Preintegration for Real-Time Visual-Inertial Odometry</a> ì˜ ë³¸ì§ˆë„ ì‚¬ì‹¤ ì´ê²ƒì´ ì „ë¶€ì´ë©°â€¦ ì«„ í•„ìš”ê°€ ì—†ê² ë‹¤.</li>
  <li>ê²°ë¡ ì ìœ¼ë¡œ ê°„ë‹¨í•œ measurement 3ê°œ ì§œë¦¬ rotation averaging ì´ë¼ëŠ” taskë¥¼ ì§ì ‘ from-scratch ë¶€í„° êµ¬í˜„í•´ë´„ìœ¼ë¡œì¨, ê²°ë¡ ì ìœ¼ë¡œëŠ” ìµœì‹  visual inertial odometry ë°©ë²•ë„ ì´ë¡ ì ìœ¼ë¡œëŠ” ê°™ë‹¤ëŠ” ì´ì•¼ê¸°ë¥¼ í•˜ê³  ì‹¶ì—ˆë‹¤.</li>
</ul>

<h2 id="ì‹¤ìŠµ">ì‹¤ìŠµ</h2>
<ul>
  <li>ì‹¤ìŠµ ì½”ë“œëŠ” ì—¬ê¸° (<a href="https://github.com/gisbi-kim/numerical_geometric_programming_lectures/blob/main/python/single_rotation_averaging/main_onmanifold_ganussnewton.py">main_onmanifold_ganussnewton.py</a>) ì— ìˆë‹¤. (ë””íœë˜ì‹œëŠ” ìœ ëª…í•œ numpy ì™€ matplotlib ì´ë¯€ë¡œ ë³„ë„ ë„ì»¤í™˜ê²½ ì„¤ì •ì€ ìƒëµí•˜ê³  ì‹¤ìŠµí•´ë³´ì.)</li>
  <li>GN ìµœì í™” ê³¼ì •ì—ì„œ weight ë¥¼ ê³ ë ¤í•œ update ì˜ˆì‹œë¥¼ êµ¬í˜„í•´ë³´ì. ì˜ˆë¥¼ ë“¤ì–´ì„œ 3ê°œì˜ measurement ì¤‘ í•˜ë‚˜ë¥¼ íŠ¹íˆ ë” ì‹ ë¢°í•˜ê³  ì‹¶ë‹¤ë©´?
    <ul>
      <li>ì´ë¥¼ ë” í™•ì¥í•˜ë©´ outlier robust rotation averaging ê¹Œì§€ ì‹¤ìŠµí•´ë³¼ ìˆ˜ ìˆê² ë‹¤. ì‹¬í•œ outlier ë¥¼ í¬í•¨í•œ, 100ê°œì˜ measurement ì¸ ê²½ìš°ë¡œ í™•ëŒ€í•´ë³´ì.</li>
    </ul>
  </li>
</ul>

  </div>

  <hr style="border:1px foo rgb(193, 198, 200)"><div id="disqus_thread" style="margin-top:25px"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://localhost:4000/slam/2024/08/24/rot-avg1.html';
      this.page.identifier = 'http://localhost:4000/slam/2024/08/24/rot-avg1.html';
    };
    (function () {
      var d = document, s = d.createElement('script');
      s.src = 'https://robotics.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments
      powered by Disqus.</a></noscript></div>

    </section>
    <footer class="condensed">
      <ul class="social about-footer condensed"><a href="https://www.linkedin.com/in/giseop-kim-71683088" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><a href="https://scholar.google.com/citations?user=9mKOLX8AAAAJ&hl=ko&oi=ao" target="_blank">
          <li>
            <i class="ai ai-google-scholar"></i>
          </li>
        </a><a href="https://github.com/gisbi-kim" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://bit.ly/giseopkim" target="_blank">
          <li>
            <i class="fa fa-user" style="font-size: 2.09em;"></i>
            <!-- <i> notion</i> -->
            <!-- <i class="fa fa-user"></i> -->
          </li>
        </a><a href="https://youtube.com/channel/UCrmVMJ3KEFbDD9EtnAmDT6g" target="_blank">
          <li>
            <i class="icon-youtube"></i>
          </li>
        </a></ul><p class="about-footer condensed">&copy;
        2024</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </footer>
  </main>
  
  <script type="text/javascript" src="/assets/js/darkmode.js"></script>
  
  <script src="/assets/js/simple-jekyll-search.min.js"></script>
  <script src="/assets/js/search.js"></script>
  
</body>

</html>
